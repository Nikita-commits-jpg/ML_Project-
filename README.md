
# Обучение с учителем: оценка качества модели.

Интернет-магазин **«В один клик»** продаёт разные товары: для детей, для дома, мелкую бытовую технику, косметику и даже продукты. Отчёт магазина за прошлый период показал, что активность покупателей начала снижаться. Привлекать новых клиентов уже не так эффективно: о магазине и так знает большая часть целевой аудитории. Возможный выход — удерживать активность постоянных клиентов. Сделать это можно с помощью персонализированных предложений.


## Введение
В условиях современного рынка, где конкуренция между интернет-магазинами становится всё более жёсткой, поддержание активности клиентов является одной из ключевых задач. Интернет-магазин «В один клик», предлагая широкий ассортимент товаров, столкнулся с снижением активности покупателей. Привлечение новых клиентов уже не приносит прежнего эффекта, так как о магазине знает большая часть целевой аудитории.

В связи с этим возникает необходимость разработки решения, которое позволит удерживать интерес постоянных клиентов и стимулировать их покупательскую активность. Одним из возможных путей является использование персонализированных предложений, которые будут учитывать предпочтения и поведение каждого клиента.

Цель данного проекта — разработать решение для персонализации предложений постоянным клиентам интернет-магазина «В один клик» с целью увеличения их активности и, как следствие, повышения общей эффективности бизнеса.
## Содержание
1) ### Вступление
1.1) Описание проектной работы

1.2) Описание данных

1.3) Импорт библиотек и модулей Python для работы с проектом 

2) ### Считывание данных CSV-формата и создание DataFrame
2.1) Обработка файла CSV-формата `market_data.csv`

2.2) Обработка файла CSV-формата `market_money.csv`

2.3) Обработка файла CSV-формата `market_time.csv`

2.4) Обработка файла CSV-формата `money.csv`

3) ### Предобработка данных
3.1) Создание собственных функций для предобработки данных
3.2) Предобработка `market_data` (DataFrame №1)

3.3) Предобработка `market_money` (DataFrame №2)

3.4) Предобработка `market_time` (DataFrame №3)

3.5) Предобработка `generated_money` (DataFrame №4)

3.6) Общие выводы по главе `Предобработка данных`

4) ### Исследовательский анализ данных
4.1) Создание собственных функций для исследовательского анализа данных

4.2) Проведение исследовательского анализа данных по признакам, которые описывают коммуникацию сотрудников компании с клиентом

4.3) Проведение исследовательского анализа данных по признакам, которые описывают продуктовое поведение клиентов

4.4) Проведение исследовательского анализа данных по признакам, описывающих поведение клиентов на сайте

4.5) Проведение исследовательского анализа данных по признакам, которые описывают финансовое поведение всех клиентов на сайте

4.6) Проведение исследовательского анализа данных по средней прибыли продавца-заказчика за последние 3 месяца по всем клиентам

4.7) Исследовательский анализ активных и неактивных покупателей

4.8) Общие выводы по главе `Исследовательский анализ данных`

5) ### Объединение таблиц
5.1) Добавление новых столбцов в DataFrame

5.2) Объединение DataFrame №1-№3 в общий

5.3)Общие выводы по главе `Объединение таблиц DataFrame`

6) ### Корреляционный анализ данных
6.1) Корреляционный анализ количественных данных при помощи коэффициента корреляции Пирсона

6.2) Корреляционный анализ переменных при помощи коэффициента корреляции Phik

6.3) Корреляционный анализ категориальных и количественных данных при помощи коэффициента корреляции Phik при разных значениях целевого признака 

6.4) Анализ признаков из общего дата-сета на мультиколлиниарность 

6.5) Общий вывод по главе корреляционный анализ данных 

7) ### Использование пайплайнов 
7.1) Подготовка данных к машинному обучению (создание пайплайнов)

7.2) Настройка и подготовка моделей

7.3) Сравнение полученной модели с Dummy-моделью

7.4) Общие выводы по главе использование пайплайнов

8) ### Анализ важности признаков
8.1) Оценка важности признаков для лучшей модели и построение графиков важности с помощью метода SHAP

8.2) Общие выводы по главе анализ значимости признаков

9) ### Сегментация покупателей 
9.1) Сегментация покупателей группы клиентов с высокой вероятностью снижения покупательской активности и наиболее высокой прибыльностью с использованием результатов моделирования и данных о прибыльности покупателей

9.2) Исследовательский анализ выбранной группы покупателей

9.3) Общие выводы по приведенному сегменту клиентов

10) ### Общие выводы по проекту
## Требования к окружению с инструкциями по установке и запуску
Для корректной работы вашего проекта необходимо установить следующие библиотеки и модули:

Matplotlib для визуализации данных:

!pip install matplotlib==3.5 -q

Phik для анализа корреляций:

!pip install phik -q

SHAP для интерпретации моделей машинного обучения:

!pip install shap -q

Scikit-learn для машинного обучения и анализа данных:

!pip install scikit-learn==1.1.3 -q
!pip install -U scikit-learn

Также проект использует следующие стандартные библиотеки Python: - Numpy - Pandas - Seaborn - IPython.display - Scipy - Statsmodels

Убедитесь, что у вас установлены все перечисленные библиотеки и модули, чтобы избежать ошибок при запуске проекта.


## Структура проекта
Описание компонентов: 
- папка raw_data: здесь хранятся все сырые (raw) данные. 

- папка notebook: в этой папке хранится notebook с готовым проектом, включающий в себя обученные модели. 

- папка description: файл формата README.md с общей информацией о проекте, требованиями к окружению и инструкциями по запуску.
## Описание данных:
Данные были получены из системы управления заказами интернет-магазина. Они представлены в формате CSV и содержат информацию о заказах, клиентах и товарах.

**Таблица №1 - `market_file.csv`** (Содержит данные о поведении покупателя на сайте, о коммуникациях с покупателем и его продуктовом поведении).

Ниже приведена **`номенклатура`** данной таблицы:


**id** — номер покупателя в корпоративной базе данных.


**Покупательская активность** — рассчитанный класс покупательской активности (целевой признак): «снизилась» или «прежний уровень».


**Тип сервиса** — уровень сервиса, например «премиум» и «стандарт». Зависит от наличия определенной подписки у пользователя.


**Разрешить сообщать** — информация о том, можно ли присылать покупателю дополнительные предложения о товаре. Согласие на это даёт покупатель.


**Маркет_актив_6_мес** — среднемесячное значение маркетинговых коммуникаций компании, которое приходилось на покупателя за последние 6 месяцев. Это значение показывает, какое число рассылок, звонков, показов рекламы и прочего приходилось на клиента.


**Маркет_актив_тек_мес** — количество маркетинговых коммуникаций в текущем месяце.


**Длительность** — значение, которое показывает, сколько дней прошло с момента регистрации покупателя на сайте.


**Акционные_покупки** — среднемесячная доля покупок по акции от общего числа покупок за последние 6 месяцев.

**Таблица №2 - `market_money.csv`** (Таблица с данными о выручке, которую получает магазин с покупателя, то есть сколько покупатель всего потратил за период взаимодействия с сайтом).

Ниже приведена **`номенклатура`** данной таблицы:

**id** — номер покупателя в корпоративной базе данных.

**Период** — название периода, во время которого зафиксирована выручка. Например, 'текущий_месяц' или 'предыдущий_месяц'.

**Выручка** — сумма выручки за период в условных единицах.

**Таблица №3 - `market_time.csv`** (Таблица с данными о времени (в минутах), которое покупатель провёл на сайте в течение периода).

Ниже приведена **`номенклатура`** данной таблицы:

**id** — номер покупателя в корпоративной базе данных.

**Период** — название периода, во время которого зафиксировано общее время.

**минут** — значение времени, проведённого на сайте, в минутах.

**Таблица №4 - `money.csv`** (Таблица с данными о среднемесячной прибыли продавца за последние 3 месяца: какую прибыль получает магазин от продаж каждому покупателю).

Ниже приведена **`номенклатура`** данной таблицы:

**id** — номер покупателя в корпоративной базе данных.


**Прибыль** — значение прибыли в условных единицах.


**Популярная_категория** — самая популярная категория товаров у покупателя за последние 6 месяцев.


**Средний_просмотр_категорий_за_визит** — показывает, сколько в среднем категорий покупатель просмотрел за визит в течение последнего месяца.


**Неоплаченные_продукты_штук_квартал** — общее число неоплаченных товаров в корзине за последние 3 месяца.


**Ошибка_сервиса** — число сбоев, которые коснулись покупателя во время посещения сайта за последние 3 месяца.


**Страниц_за_визит** — среднее количество страниц, которые просмотрел покупатель за один визит на сайт за последние 3 месяца.
##  Методы и алгоритмы
В проекте используются следующие методы и алгоритмы:

В главах предобработка данных и исследовательский анализ данных используются стандартные методики проведения работ - применение библиотек pandas, matplolib, seaborn.  

В главе корреляционный анализ с целью оценки степени корреляции применяется коэффициенты корреляции Пирсона и Phik. Кроме этого, в качестве дополнительной оценки мультиколлиниарности был применен метод VIF. 

В главе, посвященной машинному обучению, были использованы следующие модели: 

- DecisionTreeClassifier
- KNeighborsClassifier
- LogisticRegression
- SVC
С целью получения лучших метрик был произведен перебор гиперпараметров вышеприведенных моделей с помощью метода RandomizedSearch

Кроме этого, одним из критериев оценки качества модели была оценка путем сравнения полученных метрик лучшей модели с Dummy-моделью

Анализ важности признаков производился согласно методу SHAP 

Дальнейшие главы опирались на результаты моделирования, полученные в соответствующих главах.
## Основные результаты и выводы
- Клиенты чаще всего смотрят 3-4 категории товаров, нужно провести работу с интерактивным взаимодействием на сайте для привлечения;
- Необходимо увеличить количество и, возможно, улучшить способы взаимодействия с клиентами: в среднем на одного клиента приходится в районе 4 контакта, это немного;
- Пользователи не оплачивают в среднем 4 единиц товара от заказа, этот показатель тоже можно улучшить - частично, вину за это можно наложить на сам сайт, о нем подробнее ниже; 
- Происходят частые сбои на сайте - 5,6, что влияет на общий комфорт и опыт от нахождения от этого самого сайта, падают из-за этого и другие показатели, например, эти же неоплаченные товары, малое количество открытых страниц за один сеанс, небольшое количество времени, проведенное на сайте;
- Также стоит заняться вопросом маркетинга остальных групп товаров, наименее популярных в магазине, к примеру, мелка бытовая техника.



